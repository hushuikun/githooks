#!/bin/sh

echo "ğŸ” æ­£åœ¨è¿›è¡Œæäº¤ä¿¡æ¯æ ¼å¼æ£€æŸ¥..."
# è¯»å–æäº¤ä¿¡æ¯
commit_msg_file="$1"
commit_msg=$(cat "$commit_msg_file")
echo "ğŸ” æäº¤ä¿¡æ¯: $commit_msg"

# å®šä¹‰ç¬¦åˆ Conventional Commits è§„èŒƒçš„æ­£åˆ™è¡¨è¾¾å¼
commit_regex="^(feat|fix|docs|style|refactor|perf|test|chore|ci|build|revert)(\(.+\))?: .{1,50}$"

# æ£€æŸ¥æäº¤ä¿¡æ¯æ˜¯å¦ç¬¦åˆè§„èŒƒ
if ! echo "$commit_msg" | grep -qE "$commit_regex"; then
    echo "âŒ æäº¤ä¿¡æ¯ä¸ç¬¦åˆè§„èŒƒ! è¯·å‚è€ƒhttps://www.conventionalcommits.org/en/v1.0.0/#summary"
    echo ""
    echo "âœ… æ­£ç¡®ç¤ºä¾‹: "
    echo "  feat(auth): add login with OAuth2"
    echo "  fix(cart): correct total price calculation"
    echo "  docs(readme): update installation guide"
    echo ""
    echo "ğŸš€ è§„åˆ™è¦æ±‚: "
    echo "  - å¼€å¤´å¿…é¡»æ˜¯ type, ä¾‹å¦‚ feat, fix, docs, style..."
    echo "  - å¯é€‰çš„ scope ç”¨ () åŒ…è£¹ï¼Œä¾‹å¦‚ (auth)"
    echo "  - ä½¿ç”¨å†’å· : åˆ†éš” type å’Œ message"
    echo "  - æäº¤ä¿¡æ¯åº”ç®€æ´ (50 å­—ç¬¦ä»¥å†…) "
    exit 1
fi

echo "âœ… å®Œæˆæäº¤ä¿¡æ¯æ ¼å¼æ£€æŸ¥ï¼"
